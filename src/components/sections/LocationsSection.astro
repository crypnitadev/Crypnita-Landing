---
import ImageComp from "../ImageComp.astro";
import Title from "../Title.astro";
import Section from "../Section.astro";


interface Location {
  title: string;
  address: string;
  mapImage: string;
  locationImage: string;
}

const locations: Location[] = [
  {
    title: "Chao - La Libertad",
    address: "Av Ayacucho Mz 16 Lt 02",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Chimbote - La Libertad",
    address: "Urbanización Miguel Grau Mz.W2 Lt.2 Nuevo Chimbote",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Chimbote - La Libertad",
    address: "Mz. A6 Lt.17 Bellamar Segunda Etapa",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Huaraz - Ánchash",
    address: "Av. Agustín Gamarra 835",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Virú - La Libertad",
    address: "Calle libertad 281",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Chiclayo",
    address: "Calle Virú 448, La Victoria 14007",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Ferreñafe",
    address: "Calle Santa Rosa Mz F Lt 46 urb. Los Ángeles.",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Piura",
    address: "Av. Junín No. 343, Piura",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Catacaos",
    address: "Urbanización Trujillo 902",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Bagua Grande",
    address: "Av. Héroes del Cenepa 1178",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
  {
    title: "Morrope",
    address: "Av. Mexico Nº413 Morrope",
    mapImage: "/src/assets/img/locations/map.png",
    locationImage: "/src/assets/img/locations/location.png",
  },
];
---

<Section id="locations">
  <Title title="Orb points" />
  <div class="relative">
    <div class="flex overflow-hidden items-center justify-center">
      <div
        class="relative w-full max-w-5xl"
      >
        <div
          id="locationSlider"
          class="flex transition-transform duration-500 ease-in-out"
        >
          {
            locations.map((location, _) => (
              <div class="w-full flex-shrink-0 text-center p-4">
                <h2 class="text-3xl font-bold mb-2">{location.title}</h2>
                <p class="mb-4 text-lg">{location.address}</p>
                <div class="grid md:grid-cols-2 gap-4">
                  <div class="relative aspect-video rounded-xl overflow-hidden">
                    <ImageComp
                      imagePath={location.mapImage}
                      altText="Mapa"
                      width={800}
                      height={400}
                    />
                    <button class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/70 hover:bg-black/90 text-white px-6 py-2 rounded-full transition">
                      Ubicación
                    </button>
                  </div>
                  <div class="relative aspect-video rounded-xl overflow-hidden">
                    <ImageComp
                      imagePath={location.locationImage}
                      altText="Ubicación"
                      width={800}
                      height={400}
                    />
                    <button class="absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/70 hover:bg-black/90 text-white px-6 py-2 rounded-full transition">
                      Ver video
                    </button>
                  </div>
                </div>
              </div>
            ))
          }
        </div>
        <!-- Navigation Buttons -->
        <button
          id="prevBtn"
          class="absolute top-1/2 left-0 -translate-y-1/2 bg-white/10 hover:bg-white/20 rounded-full p-2"
        >
          &#9664;
        </button>
        <button
          id="nextBtn"
          class="absolute top-1/2 right-0 -translate-y-1/2 bg-white/10 hover:bg-white/20 rounded-full p-2"
        >
          &#9654;
        </button>
      </div>
    </div>
  </div>
  <!-- Dots Navigation -->
  <div class="flex justify-center gap-2 mt-4">
    {
      locations.map((_, index) => (
        <button
          class={`w-3 h-3 rounded-full transition ${index === 0 ? "bg-white/50" : "bg-white/30"}`}
          data-index={index}
        />
      ))
    }
  </div>
</Section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const slider = document.getElementById("locationSlider");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const dots = document.querySelectorAll("[data-index]");
    let currentSlide = 0;
    const totalSlides = dots.length;

    function updateSlider() {
      if (slider) {
        slider.style.transform = `translateX(-${currentSlide * 100}%)`;
      }
      dots.forEach((dot, index) => {
        dot.classList.toggle("bg-white/50", index === currentSlide);
        dot.classList.toggle("bg-white/30", index !== currentSlide);
      });
    }

    if (prevBtn) {
      prevBtn.addEventListener("click", () => {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateSlider();
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener("click", () => {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateSlider();
      });
    }

    dots.forEach((dot, index) => {
      dot.addEventListener("click", () => {
        currentSlide = index;
        updateSlider();
      });
    });
  });
</script>
